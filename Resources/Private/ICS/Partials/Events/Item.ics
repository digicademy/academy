{namespace n=Tx_News_ViewHelpers}

BEGIN:VEVENT
SUMMARY:{newsItem.title}
DESCRIPTION:{newsItem.teaser}
DTSTAMP:{newsItem.datetime}

<f:if condition="'<f:format.date>{newsItem.eventEnddate}</f:format.date>' != ''">
    <!-- Multiple day event -->
    <f:then>
        <f:if condition="{newsItem.eventStarttime}">
            <!-- Multiple day event with time -->
            <f:then>

                DTSTART:<f:format.date format="Ymd">{newsItem.eventStartdate}</f:format.date>T<f:format.date format="His">{newsItem.eventStarttime}</f:format.date>Z

                <f:if condition="{newsItem.eventEndtime}">
                    <f:then>

                        DTEND:<f:format.date format="Ymd">{newsItem.eventEnddate}</f:format.date>T<f:format.date format="His">{newsItem.eventEndtime}</f:format.date>Z

                    </f:then>
                    <f:else>

                        DTEND:<f:format.date format="Ymd">{newsItem.eventEnddate}</f:format.date>T000000Z

                    </f:else>
                </f:if>
            </f:then>
            <!-- Multiple day event without time -->
            <f:else>

                DTSTART:<f:format.date format="Ymd">{newsItem.eventStartdate}</f:format.date>T000000Z
                DTEND:<f:format.date format="Ymd">{newsItem.eventEnddate}</f:format.date>T000000Z

            </f:else>
        </f:if>
    </f:then>
    <!-- One day event -->
    <f:else>
        <f:if condition="{newsItem.eventStarttime}">
            <!-- One day event with time -->
            <f:then>

                DTSTART:<f:format.date format="Ymd">{newsItem.eventStartdate}</f:format.date>T<f:format.date format="His">{newsItem.eventStarttime}</f:format.date>Z

                <f:if condition="{newsItem.eventEndtime}">
                    <f:then>

                        DTEND:<f:format.date format="Ymd">{newsItem.eventStartdate}</f:format.date>T<f:format.date format="His">{newsItem.eventEndtime}</f:format.date>Z

                    </f:then>
                </f:if>
            </f:then>
            <!-- One day event without time -->
            <f:else>

                DTSTART:<f:format.date format="Ymd">{newsItem.eventStartdate}</f:format.date>T000000Z

            </f:else>
        </f:if>
    </f:else>
</f:if>

<f:if condition="{newsItem.eventLocation}">

    LOCATION:{newsItem.eventLocation}

</f:if>

END:VEVENT